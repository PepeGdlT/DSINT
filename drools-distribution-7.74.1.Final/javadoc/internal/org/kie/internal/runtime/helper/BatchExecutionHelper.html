<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.15) on Thu Jul 13 11:42:09 EDT 2023 -->
<title>BatchExecutionHelper (KIE :: Internal 7.74.1.Final API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2023-07-13">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BatchExecutionHelper (KIE :: Internal 7.74.1.Final API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchExecutionHelper.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>KIE :: Internal 7.74.1.Final</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.kie.internal.runtime.helper</a></div>
<h2 title="Class BatchExecutionHelper" class="title">Class BatchExecutionHelper</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.kie.internal.runtime.helper.BatchExecutionHelper</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">BatchExecutionHelper</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block"><p>
 Provides a configured XStream instance to support the marshalling of BatchExecutions, where the resulting
 xml can be used as a message format. Configured converters only exist for the commands supported via the
 CommandFactory. The user may add other converters for their user objects.
 </p>

 <p>
 This is very useful for scripting stateless of stateful knowledge sessions, especially when services are involved.
 </p>

 <p>
 There is current no xsd for schema validation, however we will try to outline the basic format here and the drools-pipeline module
 has an illustrative unit test in the XStreamBatchExecutionTest unit test. The root element is &lt;batch-execution&gt; and it can contain zero or more
 commands elements.
 </p>
 <pre>
 &lt;batch-execution&gt;
 ...
 &lt;/batch-execution&gt;
 </pre>

 <p>
 This contains a list of elements that represent commands, the supported commands is limited to those Commands provided by the CommandFactory. The
 most basic of these is the &lt;insert&gt; element, which inserts objects. The contents of the insert element is the user object, as dictated by XStream.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;insert&gt;
     ....
     &lt;/insert&gt;
 &lt;/batch-execution&gt;
 </pre>
 <p>
 The insert element supports an 'out-identifier' attribute, this means the inserted object's FactHandle will be returned
 and optionally the object itself as part of the &lt;batch-execution-results&gt; payload. To return the object use the attribute 'return-object' which takes a boolean
 'true'|'false' value, by default this is true.
 The
 </p>
 <pre>
 &lt;batch-execution &gt;
     &lt;insert out-identifier='userVar' &gt;
     ....
     &lt;/insert&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>
 It's also possible to insert a collection of objects using the &lt;insert-elements&gt; element, here each element is inserted in turn. This command also support's an
 'out-identifier' attribute which returns the FactHandle's in a Collection, of the same order that the objects where inserted. 'return-object' is also supported to optionally
 return the inserted objects, again they will be in a collection of the same order they where inserted.
 The org.domain.UserClass is just an illustrative user object that xstream would serialise.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;insert-elements&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
     &lt;/insert-elements&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>
 Next there is the &lt;set-global&gt; element, which sets a global for the session.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;set-global identifier='userVar'&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
     &lt;/set-global&gt;
 &lt;/batch-execution&gt;
 </pre>
 <p>
 &lt;set-global&gt; also supports two other optional attributes 'out' and 'out-identifier'. 'out' is a boolean and when set the global will be added to the
 &lt;batch-execution-results&gt; payload using the name from the 'identifier' attribute. 'out-identifier' works like 'out' but additionally allows you to
 override the identifier used in the &lt;batch-execution-results&gt; payload.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;set-global identifier='userVar1' out='true'&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
     &lt;/set-global&gt;
     &lt;set-global identifier='userVar2' out-identifier='alternativeUserVar2'&gt;
         &lt;org.domain.UserClass&gt;
         ...
         &lt;/org.domain.UserClass&gt;
     &lt;/set-global&gt;
 &lt;/batch-execution&gt;
 </pre>
 <p>
 There is also a &lt;get-global&gt; element, which has no contents but does support an 'out-identifier' attribute, there is no need for an 'out' attribute
 as we assume that a &lt;get-global&gt; is always an 'out'.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;get-global identifier='userVar1' /&gt;
     &lt;get-global identifier='userVar2' out-identifier='alternativeUserVar2'/&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>Specific objects can be retrieved using the FactHandle:</p>
 <pre>
 &lt;batch-execution&gt;
     &lt;get-object out-identifier='outStilton' factHandle='" + factHandle.toExternalForm() + "' /&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>
 While the 'out' attribute is useful in returning specific instances as a result payload, we often wish to run actual querries. Both parameter
 and parameterless querries are supported. The 'name' attribute is the name of the query to be called, and the 'out-identifier' is the identifier
 to be used for the query results in the &lt;batch-execution-results&gt; payload.
 </p>
 <pre>
 &lt;batch-execution&gt;
     &lt;query out-identifier='cheeses' name='cheeses'/&gt;
     &lt;query out-identifier='cheeses2' name='cheesesWithParams'&gt;
         &lt;string&gt;stilton&lt;/string&gt;
         &lt;string&gt;cheddar&lt;/string&gt;
     &lt;/query&gt;;
 &lt;/batch-execution&gt;
 </pre>

 <p>
 The &lt;start-process&gt; command is also supported and accepts optional parameters:
 </p>
 <pre>
 &lt;batch-execution&gt;
  &lt;startProcess processId='org.kie.actions'&gt;
    &lt;parameter identifier='person'&gt;
       &lt;org.kie.TestVariable&gt;
         &lt;name&gt;John Doe&lt;/name&gt;
       &lt;/org.kie.TestVariable&gt;
    &lt;/parameter&gt;
  &lt;/startProcess&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>SignelEvent</p>
 <pre>
 &lt;signal-event process-instance-id='1' event-type='MyEvent'&gt;
     &lt;string&gt;MyValue&lt;/string&gt;
 &lt;/signal-event&gt;
 </pre>

 <p>CompleteWorkItem</p>
 <pre>
 &lt;complete-work-item id='" + workItem.getId() + "' &gt;
    &lt;result identifier='Result'&gt;
         &lt;string&gt;SomeOtherString&lt;/string&gt;
     &lt;/result&gt;
 &lt;/complete-work-item&gt;
 </pre>

 <p>AbortWorkItem</p>
 <pre>
 &lt;abort-work-item id='21' /&gt;
 </pre>

 <p>
 Support for more commands will be added over time.
 </p>

 <p>
 The following is a simple insert batch-execution command:
 </p>
 <pre>
 &lt;batch-execution&gt;
   &lt;insert out-identifier='outStilton'&gt;
     &lt;org.kie.Cheese&gt;
       &lt;type&gt;stilton&lt;/type&gt;
       &lt;price&gt;25&lt;/price&gt;
       &lt;oldPrice&gt;0&lt;/oldPrice&gt;
     &lt;/org.kie.Cheese&gt;
   &lt;/insert&gt;
 &lt;/batch-execution&gt;
 </pre>

 <p>
 The pipeline can be used to handle this end to end, notice the part where the configured XStream instance is passed "BatchExecutionHelper.newXStreamMarshaller()".
 This will take a given xml, transform it and then execute it as a BatchExecution Command. Notice the Pipeline also handles the marshalling
 of the ExecutionResults back out to XML.
 </p>
 <pre>
 Action executeResultHandler = PipelineFactory.newExecuteResultHandler();

 Action assignResult = PipelineFactory.newAssignObjectAsResult();
 assignResult.setReceiver( executeResultHandler );

 Transformer outTransformer = PipelineFactory.newXStreamToXmlTransformer( BatchExecutionHelper.newXStreamMarshaller() );
 outTransformer.setReceiver( assignResult );

 KnowledgeRuntimeCommand batchExecution = PipelineFactory.newBatchExecutor();
 batchExecution.setReceiver( outTransformer );


 Transformer inTransformer = PipelineFactory.newXStreamFromXmlTransformer( BatchExecutionHelper.newXStreamMarshaller() );
 inTransformer.setReceiver( batchExecution );

 Pipeline pipeline = PipelineFactory.newStatelessKnowledgeSessionPipeline( ksession );
 pipeline.setReceiver( inTransformer );
 </pre>

 <p>
 The results would look like following xml:
 </p>
 <pre>
 &lt;execution-results&gt;
   &lt;result identifier='outStilton'&gt;
     &lt;org.kie.Cheese&gt;
       &lt;type&gt;stilton&lt;/type&gt;
       &lt;oldPrice&gt;0&lt;/oldPrice&gt;
       &lt;price&gt;30&lt;/price&gt;
     &lt;/org.kie.Cheese&gt;
   &lt;/result&gt;
 &lt;/execution-results&gt;
 </pre>

 <p>This api is experimental and thus the classes and the interfaces returned are subject to change.</p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">BatchExecutionHelper</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static com.thoughtworks.xstream.XStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newJSonMarshaller()">newJSonMarshaller</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static com.thoughtworks.xstream.XStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newXStreamMarshaller()">newXStreamMarshaller</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BatchExecutionHelper</h4>
<pre>public&nbsp;BatchExecutionHelper()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="newXStreamMarshaller()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newXStreamMarshaller</h4>
<pre class="methodSignature">public static&nbsp;com.thoughtworks.xstream.XStream&nbsp;newXStreamMarshaller()</pre>
</li>
</ul>
<a id="newJSonMarshaller()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>newJSonMarshaller</h4>
<pre class="methodSignature">public static&nbsp;com.thoughtworks.xstream.XStream&nbsp;newJSonMarshaller()</pre>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchExecutionHelper.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>KIE :: Internal 7.74.1.Final</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2001&#x2013;2023 <a href="http://www.jboss.org/">JBoss by Red Hat</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
